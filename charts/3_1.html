<h5 class="card-title">Chart 1</h5>
<!-- Create a container to host the charts -->

<!-- Include d3 library -->
<script src="https://d3js.org/d3.v7.min.js"></script>

<!-- Load slider -->
<script src="https://unpkg.com/d3-simple-slider"></script>


<!-- first chart -->
<!-- Create a container to host the chart -->
<div id="container"></div>


<script>
// Declare the chart dimensions and margins.
const margin = { top: 20, right: 60, bottom: 60, left: 60 }
const width = 700 - margin.left - margin.right;
const height = 300 - margin.top - margin.bottom;

// Create the SVG container.
const svg = d3.select("#container")
.append("svg")
.attr("width", width + margin.left + margin.right)
.attr("height", height + margin.top + margin.bottom)
.append("g")
.attr("transform", "translate(" + margin.left + "," + margin.top + ")");

// Load CSV data
d3.csv("https://raw.githubusercontent.com/guidovalla/DV_project/main/data/3_1.csv")
.then((data) => {
// Extract unique years and age categories
let years = [...new Set(data.map(d => d.Year))];
const ages = data.columns.slice(1); // Exclude 'Year' column


// Declare the x (horizontal position) scale.
const x = d3.scaleBand()
.domain(ages)
.range([0, width])
.padding(0.2);

// Declare the y (vertical position) scale.
const y = d3.scaleLinear()
.domain([0, d3.max(data, d => d3.max(ages.map(age => +d[age])))])
.range([height, 0]);

// Initial bars
updateBars(data[0].Year);

// Update bars when year changes
function updateBars(selectedYear) {
svg.selectAll("*").remove();

const dataFilter = data.find(d => d.Year == selectedYear);

svg.selectAll(".bar")
  .data(ages)
  .enter()
  .append("rect")
  .attr("class", "bar")
  .attr("x", (age) => x(age))
  .attr("y", (age) => y(dataFilter[age]))
  .attr("width", x.bandwidth())
  .attr("height", (age) => height - y(dataFilter[age]))
  .attr("fill", "#69b3a2");

// X-axis
svg.append("g")
  .attr("transform", "translate(0," + height + ")")
  .call(d3.axisBottom(x))
  .selectAll("text")
  .attr("transform", "translate(-10,0)rotate(-45)")
  .style("text-anchor", "end");

 


  svg
.append("text")
.attr("class", "chart-label")
.attr("x", -(margin.left)*0.7)
.attr("y", -(margin.top/9))
.attr("text-anchor", "start")
.text("Number of deaths")


// Y-axis
svg.append("g")
  .call(d3.axisLeft(y));
}
var year=data[0].Year
const sliderRange= d3
.sliderBottom()
.min(1950)
.max(2021)
.width(300)
.step(1)
.tickFormat(d3.format('Y'))
.ticks(5)
.default(year)
.on('onchange', val => {
    year = val
      updateBars(year)
    })
        const gRange= d3.
        select('#container')
        .append("svg")
        .attr("width", 400 + margin.left + margin.right)
        .attr("height", 10 + margin.top + margin.bottom)
        .append("g")
        .attr("transform","translate(" + margin.left + "," + margin.top + ")")
        .call(sliderRange);



})
.catch((err) => {
console.log({ err });
});
</script>